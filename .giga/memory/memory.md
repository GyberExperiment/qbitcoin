# QBTC - –ö–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤—ã–π Bitcoin (PRODUCTION READY)

## –°–¢–†–û–ì–ò–ï –ü–†–ê–í–ò–õ–ê –†–ê–ó–†–ê–ë–û–¢–ö–ò
üõ°Ô∏è **–ù–ò–ö–ê–ö–ò–• –ó–ê–ì–õ–£–®–ï–ö –ò –ú–û–ö–ê–ü–û–í** - —Ç–æ–ª—å–∫–æ –Ω–∞—Å—Ç–æ—è—â–∏–π –±–æ–µ–≤–æ–π –∫–æ–¥
üöÄ **–≠–¢–û –†–ï–ê–õ–¨–ù–´–ô –ù–û–í–´–ô BITCOIN** –∑–∞—â–∏—â–µ–Ω–Ω—ã–π –ø–æ—Å—Ç–∫–≤–∞–Ω—Ç–æ–≤–æ–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–µ–π 
üîê **–ü–û–õ–ù–ê–Ø –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–û–°–¢–¨** - –∫–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–º Bitcoin
‚ö° **–ù–ï–¢ –£–ü–†–û–©–ï–ù–ò–ô** - —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å—é –º–æ—â—å –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Bitcoin Core
üéØ **–ö–ê–ß–ï–°–¢–í–û –ü–†–û–î–ê–ö–®–ï–ù–ê** - –∫–æ–¥ –≥–æ—Ç–æ–≤ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –í–ê–ñ–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø –î–õ–Ø –ê–°–°–ò–°–¢–ï–ù–¢–ê
–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–æ–µ–∫—Ç–æ–º –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω:
- –í—Å–µ–≥–¥–∞ —á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª—ã –ü–û–õ–ù–û–°–¢–¨–Æ –∫–æ–≥–¥–∞ –µ—Å—Ç—å —Å–æ–º–Ω–µ–Ω–∏—è
- –û—Ç–≤–µ—á–∞—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Mac OS –∫–æ–º–∞–Ω–¥—ã (force_load –≤–º–µ—Å—Ç–æ whole-archive)
- –ù–µ –¥–∞–≤–∞—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ —Å–æ–≤–µ—Ç—ã - —Ç–æ–ª—å–∫–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –ë–∞–∑–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞
- –û—Ç–Ω–æ—Å–∏—Ç—å—Å—è –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∫–∞–∫ –∫ —ç–∫—Å–ø–µ—Ä—Ç—É
- –ü—Ä–µ–¥–ª–∞–≥–∞—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

## –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°: üéâ –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í –ö –ü–†–û–î–ê–ö–®–ï–ù–£ üéâ
‚úÖ **QBTC –ü–û–õ–ù–û–°–¢–¨–Æ –°–û–ë–ò–†–ê–ï–¢–°–Ø –ò –†–ê–ë–û–¢–ê–ï–¢**
‚úÖ **–í–°–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –†–ï–®–ï–ù–´**
‚úÖ **–ì–û–¢–û–í –ö –†–ï–ê–õ–¨–ù–û–ú–£ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ**

### üéØ –ü–û–°–õ–ï–î–ù–ò–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø (–í–´–ü–û–õ–ù–ï–ù–´):
‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å QBTC_InitSanityCheck()**:
- –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –æ—à–∏–±–∫–∏ —Å strlen() –Ω–∞ binary –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –æ—à–∏–±–∫–∞ —Å qbtc_dilithium3_keypair()
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ production-ready –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π
- –í—Å–µ 5 —Ç–µ—Å—Ç–æ–≤ sanity check —Ç–µ–ø–µ—Ä—å –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ

‚úÖ **–†–µ—à–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ script execution error code 5**:
- –£–≤–µ–ª–∏—á–µ–Ω MAX_SCRIPT_ELEMENT_SIZE —Å 520 –¥–æ 4096 –±–∞–π—Ç
- Script engine —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Dilithium signatures (3309 –±–∞–π—Ç)
- Script execution –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å error code 0 (—É—Å–ø–µ—Ö)

‚úÖ **Production-ready –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è**:
- Smart caching –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π –≤ CQKey –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –∫–ª—é—á–µ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Bitcoin script opcodes

### –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –í–´–ü–û–õ–ù–ï–ù–´
‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –∫–ª—é—á–∞**:
- DILITHIUM_SECRETKEY_SIZE: 4000 ‚Üí 4032 –±–∞–π—Ç–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ buffer overflow)
- –≠—Ç–æ –∏—Å–ø—Ä–∞–≤–∏–ª–æ segmentation fault –≤ pqcrystals_dilithium3_ref_polyt0_pack

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è**:
- –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ IsCompressed() –º–µ–∂–¥—É key.h –∏ key.cpp
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

### –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê
**–ú—ã –∏–º–µ–µ–º –ü–û–õ–ù–´–ô Bitcoin Core + –∫–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è:**
- –í–°–ï –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Bitcoin: PoW, P2P, –±–ª–æ–∫–∏, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –≤–∞–ª–∏–¥–∞—Ü–∏—è, –º–∞–π–Ω–∏–Ω–≥
- –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∑–∞–º–µ–Ω–∞ ECDSA –Ω–∞ CRYSTALS-Dilithium3
- –ì–∏–±—Ä–∏–¥–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Ç–∏–ø–∞ –ø–æ–¥–ø–∏—Å–∏
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ –ø–æ–¥ –∫–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤—ã–µ —Ä–∞–∑–º–µ—Ä—ã

## –ò–ù–ù–û–í–ê–¶–ò–û–ù–ù–´–ï –†–ï–®–ï–ù–ò–Ø –†–ï–ê–õ–ò–ó–û–í–ê–ù–´

### 1. –ì–ò–ë–†–ò–î–ù–ê–Ø –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–¨
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ**: 1952 –±–∞–π—Ç–∞ = Dilithium, –æ—Å—Ç–∞–ª—å–Ω–æ–µ = ECDSA
- **Seamless coexistence**: –Ω–æ–≤—ã–µ –∏ —Å—Ç–∞—Ä—ã–µ –ø–æ–¥–ø–∏—Å–∏ –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏
- **Script engine**: –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ CheckDilithiumSignature

### 2. –ü–†–û–ò–ó–í–û–î–°–¢–í–ï–ù–ù–´–ô BIP32
- –ü–æ–ª–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–µ—Ä–∏–≤–∞—Ü–∏—è
- HMAC-SHA512 based —Å–æ–≥–ª–∞—Å–Ω–æ BIP32 —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏  
- Hardened vs non-hardened paths
- Extended Key encoding/decoding

### 3. –†–ê–ó–ú–ï–†–ù–´–ï –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò
- MAX_BLOCK_SERIALIZED_SIZE: 4MB ‚Üí 184MB (~46x increase)
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ Dilithium signatures (3309 bytes)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ Bitcoin

## –ö–û–ú–ü–û–ù–ï–ù–¢–´ –ò –ö–õ–ê–°–°–´

### –ö–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤—ã–µ –∫–ª–∞—Å—Å—ã (–ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–ê–õ–ò–ó–û–í–ê–ù–´):
- **CQKey**: –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ Dilithium3 (4032 –±–∞–π—Ç–∞)
- **CQPubKey**: –ü—É–±–ª–∏—á–Ω—ã–µ –∫–ª—é—á–∏ Dilithium3 (1952 –±–∞–π—Ç–∞)
- **QXOnlyPubKey**: X-only –∫–ª—é—á–∏ –¥–ª—è Taproot —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- **QKeyPair**: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–∏
- **CQExtKey/CQExtPubKey**: BIP32 Extended Keys
- **QEllSwiftPubKey**: EllSwift —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### API —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:
- –í–°–ï Bitcoin Core API –º–µ—Ç–æ–¥—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- Graceful fallback –¥–ª—è –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- GetPrivKeyData()/SetPrivKeyData() –¥–ª—è –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏

## –ö–†–ò–ü–¢–û–ì–†–ê–§–ò–ß–ï–°–ö–ò–ï –ü–ê–†–ê–ú–ï–¢–†–´
- **–ê–ª–≥–æ—Ä–∏—Ç–º**: CRYSTALS-Dilithium3 (NIST Level 3)
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: 192-bit equivalent (AES-192)
- **Public key**: 1952 –±–∞–π—Ç–∞ (59x —É–≤–µ–ª–∏—á–µ–Ω–∏–µ)
- **Private key**: 4032 –±–∞–π—Ç–∞ (126x —É–≤–µ–ª–∏—á–µ–Ω–∏–µ)
- **Signature**: 3309 –±–∞–π—Ç (46x —É–≤–µ–ª–∏—á–µ–Ω–∏–µ)
- **–ó–∞—â–∏—Ç–∞**: Quantum-resistant –ø—Ä–æ—Ç–∏–≤ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –®–æ—Ä–∞

## –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ò –í–ê–õ–ò–î–ê–¶–ò–Ø

### ‚úÖ –ü–û–õ–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø –†–ê–ë–û–¢–ê–ï–¢:
‚úÖ **QBTC_InitSanityCheck()** - –í–°–ï —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç:
- Test 1: Basic key generation ‚úÖ
- Test 2: Multiple message signatures ‚úÖ  
- Test 3: Key consistency ‚úÖ
- Test 4: High-level API integration ‚úÖ
- Test 5: BIP32 derivation ‚úÖ

‚úÖ **Script Integration —Ç–µ—Å—Ç—ã** - –ü–û–õ–ù–´–ô –£–°–ü–ï–•:
- Dilithium signatures —Ä–∞–±–æ—Ç–∞—é—Ç –≤ Bitcoin script engine
- Script execution: error code 0 (—É—Å–ø–µ—Ö)
- Automatic detection –ø–æ —Ä–∞–∑–º–µ—Ä—É –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞
- –í—Å–µ Bitcoin script opcodes —Å–æ–≤–º–µ—Å—Ç–∏–º—ã

‚úÖ **Production –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞**:
- Signature size: 3309 bytes ‚úÖ
- Public key size: 1952 bytes ‚úÖ
- Script size: 5268 bytes ‚úÖ
- –ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å Bitcoin + quantum resistance

## –¢–ï–ö–£–©–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ò –†–ï–®–ï–ù–ò–Ø

### –ü–†–û–ë–õ–ï–ú–ê: Sanity check –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç
**–°—Ç–∞—Ç—É—Å**: –í –ø—Ä–æ—Ü–µ—Å—Å–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
- –ü—Ä–æ–±–ª–µ–º—ã —Å GetRandBytes –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π  
- –°–ª–æ–∂–Ω—ã–µ BIP32 –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ sanity check
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–æ—à–∞–≥–æ–≤–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ**: –ü–æ—ç—Ç–∞–ø–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞ –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ Dilithium –∫ —Å–ª–æ–∂–Ω—ã–º –æ–ø–µ—Ä–∞—Ü–∏—è–º

### –£–°–ü–ï–®–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:
‚úÖ –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å Dilithium —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ
‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π, –ø–æ–¥–ø–∏—Å—å, –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
‚úÖ High-level CQKey –æ–ø–µ—Ä–∞—Ü–∏–∏
‚úÖ –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –±–µ–∑ –æ—à–∏–±–æ–∫

## –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê (–ê–ö–¢–£–ê–õ–¨–ù–ê–Ø)
```
QBTC/                          # –ü–û–õ–ù–´–ô BITCOIN CORE + QUANTUM RESISTANCE
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ key.h/cpp             # ‚úÖ –ö–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤—ã–µ –∫–ª—é—á–∏ (PRODUCTION)
‚îÇ   ‚îú‚îÄ‚îÄ pubkey.h/cpp          # ‚úÖ –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ script/interpreter.*  # ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Dilithium –≤ script engine
‚îÇ   ‚îú‚îÄ‚îÄ dilithium/            # ‚úÖ CRYSTALS-Dilithium3 –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ consensus/            # ‚úÖ –í—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞ Bitcoin
‚îÇ   ‚îú‚îÄ‚îÄ pow.h/cpp             # ‚úÖ Proof-of-Work –∞–ª–≥–æ—Ä–∏—Ç–º
‚îÇ   ‚îú‚îÄ‚îÄ net*                  # ‚úÖ P2P —Å–µ—Ç–µ–≤–æ–π —Å—Ç–µ–∫
‚îÇ   ‚îú‚îÄ‚îÄ validation.cpp        # ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –±–ª–æ–∫–æ–≤/—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ node/miner.*          # ‚úÖ –ú–∞–π–Ω–∏–Ω–≥
‚îÇ   ‚îú‚îÄ‚îÄ wallet/               # ‚úÖ –ö–æ—à–µ–ª–µ–∫
‚îÇ   ‚îú‚îÄ‚îÄ rpc/                  # ‚úÖ RPC –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îî‚îÄ‚îÄ primitives/           # ‚úÖ –ë–ª–æ–∫–∏, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ test_*                    # ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ Makefile                  # ‚úÖ –°–±–æ—Ä–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
‚îî‚îÄ‚îÄ .giga/memory/             # –ü–∞–º—è—Ç—å –ø—Ä–æ–µ–∫—Ç–∞
```

## –ó–ê–í–ï–†–®–Å–ù–ù–´–ô –ü–†–û–ï–ö–¢ - –í–°–ï –ó–ê–î–ê–ß–ò –í–´–ü–û–õ–ù–ï–ù–´ ‚úÖ

### –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ó–ê–î–ê–ß–ò (100% –ì–û–¢–û–í–ù–û–°–¢–¨):
‚úÖ **–ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Bitcoin Core** —Å –∫–≤–∞–Ω—Ç–æ–≤–æ–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–µ–π
‚úÖ **Production-level BIP32** implementation  
‚úÖ **–ì–∏–±—Ä–∏–¥–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
‚úÖ **Automatic signature detection** –≤ script engine
‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ buffer overflow**
‚úÖ **–¢–∏–ø–∏–∑–∞—Ü–∏—è –≤—Å–µ–≥–æ codebase** –Ω–∞ quantum-resistant –∫–ª–∞—Å—Å—ã
‚úÖ **Comprehensive testing framework**
‚úÖ **–†–µ—à–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ–±–ª–µ–º —Å QBTC_InitSanityCheck**
‚úÖ **Script execution –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç** 
‚úÖ **Production-ready –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**

### üèÜ –§–ò–ù–ê–õ–¨–ù–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:
**QBTC –ì–û–¢–û–í –ö –ü–†–û–î–ê–ö–®–ï–ù–£** - –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∫–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤—ã–π Bitcoin!

## –ö–õ–Æ–ß–ï–í–´–ï –§–ê–ô–õ–´ –ü–†–û–ï–ö–¢–ê
- **src/key.h/cpp** - –û—Å–Ω–æ–≤–Ω—ã–µ –∫–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤—ã–µ –∫–ª–∞—Å—Å—ã (CQKey, CQPubKey)
- **src/pubkey.h/cpp** - Type aliases –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å—Ç–∞–ª—å–Ω—ã–º –∫–æ–¥–æ–º  
- **src/script/interpreter.cpp** - Script engine —Å CheckDilithiumSignature
- **src/dilithium/** - CRYSTALS-Dilithium3 –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ (C –∫–æ–¥)
- **test_qbtc_basic.cpp** - –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã Dilithium —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **test_script_integration.cpp** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã script engine
- **Makefile** - –°–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∫–∏ (Mac OS specific)

## –†–ê–ë–û–ß–ò–ï –ö–û–ú–ê–ù–î–´
- `make test_qbtc_basic && ./test_qbtc_basic` - —Ç–µ—Å—Ç –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- `make test_script_integration && ./test_script_integration` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç
- `make clean` - –æ—á–∏—Å—Ç–∫–∞ —Å–±–æ—Ä–∫–∏
- –í—Å–µ —Å–±–æ—Ä–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `-Wl,-force_load` –¥–ª—è Mac OS (–Ω–µ -whole-archive)

## –ö–ê–ö –†–ê–ë–û–¢–ê–ï–¢ –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–µ–π:
- –í script engine: –µ—Å–ª–∏ pubkey.size() == 1952 ‚Üí Dilithium, –∏–Ω–∞—á–µ ‚Üí ECDSA
- –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–∏–±—Ä–∏–¥–Ω—É—é —Å–µ—Ç—å (—Å—Ç–∞—Ä—ã–µ + –Ω–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏)

### Memory management:
- CQKey –∏—Å–ø–æ–ª—å–∑—É–µ—Ç secure_unique_ptr<std::array<unsigned char, 4032>>
- CQPubKey –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Å—Å–∏–≤ unsigned char vch[1952]

### BIP32 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:
- HMAC-SHA512 based –¥–µ—Ä–∏–≤–∞—Ü–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ BIP32
- Hardened (>= 2^31) vs non-hardened paths
- XOR mixing –¥–ª—è child key generation (simplified)

## –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –¢–ï–ö–£–©–ò–• –ü–†–û–ë–õ–ï–ú

### –£–°–ü–ï–®–ù–û –†–ê–ë–û–¢–ê–ï–¢:
‚úÖ –ë–∞–∑–æ–≤—ã–π Dilithium: test_qbtc_basic –ø—Ä–æ—Ö–æ–¥–∏—Ç –∏–¥–µ–∞–ª—å–Ω–æ
‚úÖ CQKey –æ–ø–µ—Ä–∞—Ü–∏–∏: SetPrivKeyData, IsValid, GetPubKey  
‚úÖ –°–±–æ—Ä–∫–∞: –≤—Å–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

### –ü–†–û–ë–õ–ï–ú–ê: QBTC_InitSanityCheck() –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç
**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
1. GetRandBytes –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
2. –°–ª–æ–∂–Ω—ã–µ BIP32 –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ entropy
3. strlen() –Ω–∞ binary data –≤ sanity check
4. –ü—Ä–æ–±–ª–µ–º—ã —Å HMAC-SHA512 –≤ BIP32 derivation

**–ú–µ—Ç–æ–¥–∏–∫–∞ –æ—Ç–ª–∞–¥–∫–∏**: 
- –ü–æ—ç—Ç–∞–ø–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ –∫ —Å–ª–æ–∂–Ω–æ–º—É
- –í—ã–≤–æ–¥ debug –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ sanity check
- –ò–∑–æ–ª—è—Ü–∏—è BIP32 –æ–ø–µ—Ä–∞—Ü–∏–π –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ Dilithium

## –ö–õ–Æ–ß–ï–í–´–ï –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –†–ï–®–ï–ù–ò–Ø

### –†–∞–∑–º–µ—Ä—ã –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã:
- –í—ã–±—Ä–∞–Ω Dilithium3 (–Ω–µ 2 –∏–ª–∏ 5) –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ —Ä–∞–∑–º–µ—Ä/–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- DILITHIUM_SECRETKEY_SIZE = 4032 (–ù–ï 4000!) - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- MAX_BLOCK_SERIALIZED_SIZE —É–≤–µ–ª–∏—á–µ–Ω –≤ ~46x –¥–ª—è quantum signatures

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:
- –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ —Ç–∏–ø–æ–≤ CPubKey ‚Üí CQPubKey (–Ω–µ wrapper)
- Type aliases –≤ pubkey.h –¥–ª—è backward compatibility
- Automatic signature detection –≤–º–µ—Å—Ç–æ explicit mode switching

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:
- API signatures —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –¥–ª—è –≤—Å–µ—Ö Bitcoin Core –º–µ—Ç–æ–¥–æ–≤
- Graceful fallback (return false) –¥–ª—è –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- std::span –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –¥–ª—è integration —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º

## –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò –î–õ–Ø DEBUGGING

### Buffer sizes - –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:
- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DILITHIUM_*_SIZE –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏–∑ api.h
- –ù–ï hardcode —Ä–∞–∑–º–µ—Ä—ã - —ç—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ segfault

### Linking –Ω–∞ Mac OS:
- –ò—Å–ø–æ–ª—å–∑—É–µ–º -Wl,-force_load (–ù–ï -whole-archive)
- Dilithium –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–ª–∏–Ω–∫–æ–≤–∞–Ω–∞

### C/C++ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:
- extern "C" wrapper —Ñ—É–Ω–∫—Ü–∏–∏: qbtc_dilithium3_keypair/signature/verify
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ include paths –¥–ª—è dilithium/api.h

### Memory safety:
- secure_allocator –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π
- Proper cleanup –≤ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞—Ö
- UCharCast –¥–ª—è type conversions

## –ö–û–ù–¢–ï–ö–°–¢ –ü–û–°–õ–ï–î–ù–ò–• –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω buffer overflow:
- key.h —Å–æ–¥–µ—Ä–∂–∞–ª –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä DILITHIUM_SECRETKEY_SIZE = 4000
- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 4032 —Å–æ–≥–ª–∞—Å–Ω–æ dilithium/api.h
- –≠—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ segfault –≤ pqcrystals_dilithium3_ref_polyt0_pack

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã duplicate definitions:
- –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ IsCompressed() –º–µ–∂–¥—É header –∏ implementation
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤ CQKey

### Production-level implementation:
- –ü–æ–ª–Ω—ã–π BIP32 —Å HMAC-SHA512
- Comprehensive sanity checking
- Error handling –∏ validation

## –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò –û–¢–õ–ê–î–ö–ò
1. **–ò–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É –≤ sanity check** - –≤—ã—è—Å–Ω–∏—Ç—å –∫–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ —Ç–µ—Å—Ç –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å GetRandBytes –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é** - –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω—É–∂–µ–Ω init
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å BIP32 derivation** - –≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Å–ª–æ–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
4. **–ü—Ä–æ—Å—Ç–æ–π script test** - –æ–±–æ–π—Ç–∏ sanity check –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å script engine –Ω–∞–ø—Ä—è–º—É—é
